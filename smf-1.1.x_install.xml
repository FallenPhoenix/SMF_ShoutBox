<?xml version="1.0"?>
<!DOCTYPE modification SYSTEM "http://www.simplemachines.org/xml/modification">
<modification xmlns="http://www.simplemachines.org/xml/modification" xmlns:smf="http://www.simplemachines.org/">
	<name>SMFPacks Shoutbox</name>
	<id>nibogo:shoutBox</id>
	<version>1.0</version>
	<homepage>http://www.hackspark.com/</homepage>
	<file name="$boarddir/index.php">
		<operation>
			<search position="before"><![CDATA[require_once($sourcedir . '/Security.php');]]></search>
			<add><![CDATA[
// Hack's Park Shoutbox -->
require_once($sourcedir . '/Subs-Shoutbox.php');
// <-- Hack's Park Shoutbox]]></add>
		</operation>
		<operation>
			<search position="replace"><![CDATA[call_user_func(smf_main());]]></search>
			<add><![CDATA[// Hack's Park Shoutbox -->
call_user_func(Shoutbox_Load(smf_main()));
// <-- Hack's Park Shoutbox]]></add>
		</operation>
		<operation>
			<search position="before"><![CDATA[!empty($modSettings['hitStats'])]]></search>
			<add><![CDATA[ && (empty($_REQUEST['action']) || $_REQUEST['action'] != 'shoutbox')]]></add>
		</operation>
		<operation>
			<search position="before"><![CDATA['serversettings2' => array('ManageServer.php', 'ModifySettings2'),]]></search>
			<add><![CDATA[
		// Hack's Park Shoutbox -->
		'shoutbox' => array('Shoutbox.php', 'Shoutbox'),
		'manageshoutbox' => array('ManageShoutbox.php', 'ManageShoutbox'),
		// <-- Hack's Park Shoutbox]]></add>
		</operation>
	</file>

	<file name="$sourcedir/Subs.php">
		<operation>
			<search position="after"><![CDATA[// Admin area 'Forum'.]]></search>
			<add><![CDATA[// Hack's Park Shoutbox -->
	if (allowedTo('admin_forum'))
		$context['admin_areas']['shoutbox'] = array(
			'title' => $txt['sba_title'],
			'areas' => array('shoutbox' => '<a href="' . $scripturl . '?action=manageshoutbox">' . $txt['sba_link'] . '</a>')
		);
	// <-- Hack's Park Shoutbox

	]]></add>
		</operation>
	</file>

	<file name="$sourcedir/ManagePermissions.php">
		<operation>
			<search position="before"><![CDATA['karma_edit' => false,
			),]]></search>
			<add><![CDATA[
			// Hack's Park Shoutbox -->
			'shoutbox' => array(
				'shoutbox_view' => false,
				'shoutbox_post' => false
			),
			'shoutbox_panel' => array(
				'shoutbox_edit' => false,
				'shoutbox_delete' => false,
				'shoutbox_prune' => false,
				'shoutbox_ban' => false
			),
			// <-- Hack's Park Shoutbox]]></add>
		</operation>
		<operation>
			<search position="before"><![CDATA[$non_guest_permissions = array(]]></search>
			<add><![CDATA[
		// Hack's Park Shoutbox -->
		'shoutbox_post',
		'shoutbox_edit',
		'shoutbox_delete',
		'shoutbox_prune',
		'shoutbox_ban',
		// <-- Hack's Park Shoutbox]]></add>
		</operation>
	</file>

	<file name="$themedir/index.template.php">
		<operation>
			<search position="after"><![CDATA[}

function template_main_below()
{]]></search>
			<add><![CDATA[	// Hack's Park Shoutbox -->
	if (function_exists('template_shoutbox')) template_shoutbox('main');
	// <-- Hack's Park Shoutbox
]]></add>
		</operation>
	</file>

	<file name="$languagedir/Modifications.english.php">
		<operation>
			<search position="end" />
			<add><![CDATA[// Hack's Park Shoutbox -->
$txt['sba_title'] = 'Shoutbox';
$txt['sba_link'] = 'Shoutbox';

$txt['permissiongroup_shoutbox'] = 'Shoutbox';
$txt['permissionname_shoutbox_view'] = 'View Shoutbox';
$txt['permissionname_shoutbox_post'] = 'Post messages in Shoutbox';
$txt['permissiongroup_shoutbox_panel'] = 'Shoutbox Moderation Panel';
$txt['permissionname_shoutbox_edit'] = 'Edit messages in Shoutbox';
$txt['permissionname_shoutbox_delete'] = 'Delete messages in Shoutbox';
$txt['permissionname_shoutbox_prune'] = 'Empty Shoutbox';
$txt['permissionname_shoutbox_ban'] = 'Ban users in Shoutbox';
// <-- Hack's Park Shoutbox
]]></add>
		</operation>
	</file>
</modification>